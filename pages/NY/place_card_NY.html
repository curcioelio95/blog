<div class="map__container">
    <div id='map' ></div>
    <div id="text-container">
        <div id="text_info_card">
            <h2 id="title_info">Everything starts fom here!</h2>
            <p id="subtitle_info">What are you looking for?</p>
            <p id="desctiption_info">This map contains a collection of the most beautiful places to visit, if you are looking for a good place to eat, or a simple suggestion for a place to spend your time, it doesn't matter! The map has everything! </p>
            <div class="map__controls">
                <button id="style1-button"><i class="fas fa-map-marked-alt"></i> Explore</button>
                <button id="style2-button"> <i class="fas fa-utensils"></i> Eat</button>
                <button id="style3-button">  <i class="fas fa-camera"></i> Shots</button>
                <button id="style4-button">  <i class="fas fa-motorcycle"></i> Trip</button>
            </div>
        </div>
    </div>
</div>

<style>
    a,p{
        font-family: Roboto;
        color: var(--text-gray) !important;
        font-size: 1em;
        font-weight: 300;
        letter-spacing: 1px;
    }
    a{
        font-weight: bold;
    }
    strong{
        font-family: Roboto;
        color: var(--text-gray) !important;
        font-size: 1.3em;
        font-weight: bold;
        font-weight: 300;
        letter-spacing: 1px;
    }
    .map__container{
        position: relative;
        height: 100vh;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
    
    }

    #map{
        flex:2;
        width: 50%;
        height: 80%;
        object-fit: cover;
        border-radius: 20px;
        box-shadow: 10px 10px 15px rgba(0,0,0,0.5);
    }

    #text-container {
            flex: 0.5;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #f0f0f0;
            width: 100%;
        }

        #text-container h2{
            font-size: 30px;
            font-weight: 600;
            letter-spacing: 1px;
            margin-bottom: 10px;
            font-family: Montserrat;
            color: var(--text-gray);
        }

        #text-container p{
            font-family: Roboto;
            color: var(--text-gray) !important;
            font-size: 16px;
            font-weight: 300;
            letter-spacing: 1px;
        }

        #text_info_card {
            text-align: center;
            margin-bottom: 20px;
            width: 100%;
        }

        #button {
            padding: 10px 20px;
            background-color: #007bff;
            color: #fff;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #button:hover {
            background-color: #0056b3;
        }

        .map__controls {
            display: grid !important;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

    .map__controls button {
    margin: 0.2em;
    padding: 0.9em 2em;
    background-color: #007bff;
    color: white;
    border: none;
    cursor: pointer;
    font-size: 1em;
    transition: background-color 0.3s;
    border-radius: 2em;
    }

    #style2-button {
    background-color: #28a745;
    }

    #style3-button {
    background-color: #dc3545;
    }

    #style4-button {
    background-color: #FFA500;
    }

    button:hover {
    background-color: #0056b3;
    }

    button#style2-button:hover {
    background-color: #218838;
    }

    button#style3-button:hover {
    background-color: #c82333;
    }

    button#style4-button:hover {
    background-color: #a36a00;
    }
        
    .symbol {
        text-decoration: none; /* Rimuove la sottolineatura del link */
        color: transparent; /* Rende il testo del link trasparente */
    }

</style>

<script>
    var img_w;
    var img_h;
    // Verifica la larghezza dello schermo
    if (window.innerWidth <= 900) { // Larghezza massima di un iPhone
        img_w = 200; // Dimensione per schermi di iPhone
        img_w = 168;
    } else {
        img_w = 220; // Dimensione per schermi più grandi
        img_h = 185;
    }

    mapboxgl.accessToken = 'pk.eyJ1IjoiZWxpb21hdHRlbzk1IiwiYSI6ImNsbHAzbTZjbDAxeGMzbXF6dTF0aTJ6OTEifQ.UbtyyNO3zrxCy9csW01oaA';
    const map = new mapboxgl.Map({
    container: 'map',
    // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
    style: 'mapbox://styles/mapbox/streets-v12',
    center: [-73.97866080866328, 40.763448563089725],
    zoom: 12.4
    }); 

  
    const mpSets = [
    //place to visit
    [
        // Array di posizioni per lo Style 1
        {
            'name':'central park', 
            'coordinates': [-73.97100729938842, 40.77420850783761],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Central Park</strong>'
            },
        },
        {
            'name':'statue of liberty', 
            'coordinates': [-74.04456511280948, 40.689217219789924],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Statue of Liberty</strong>'
            },
        },
        {
            'name':'ellis island', 
            'coordinates': [-74.03981464172467, 40.69898013939692],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Ellis Island</strong>'
            },
        },
        {
            'name':'charging bull', 
            'coordinates': [-74.01344981674086, 40.70554509879341],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Charging Bull</strong>'
            },
        },
        {
            'name':'Moma', 
            'coordinates': [-73.97778180029385, 40.761488607866596],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Museum of Modern Art</strong>'
            },
        },
        {
            'name':'met', 
            'coordinates': [-73.96308173438432, 40.77925225500468],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>the Metropolitan Museum of Art</strong>'
            },
        },
        {
            'name':'guggenheim', 
            'coordinates': [-73.95899087348762, 40.783059495729816],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Guggenheim Museum of Art</strong>'
            },
        },
        {
            'name':'museum of natural history', 
            'coordinates': [-73.97293537079719, 40.780832322869884],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>American Museum of Natural History</strong>'
            },
        },
        {
            'name':'empire', 
            'coordinates': [-73.985542, 40.748466500000006],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Empire State Building</strong>'
            },
        },
        {
            'name':'summit', 
            'coordinates': [-73.97864630068342, 40.75274344393327],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Summit One Vanderbilt</strong>'
            },
        },
        {
            'name':'central_station', 
            'coordinates': [-73.97722535890391, 40.752744337031885],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Central Station</strong>'
            },
        },
        {
            'name':'edge', 
            'coordinates': [-74.0021594628396, 40.75381717451566],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>the Edge and Vessel</strong>'
            },
        },
        {
            'name':'high_line', 
            'coordinates': [-74.00233378035726, 40.752817979881485],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>High Line</strong>'
            },
        },
        {
            'name':'Chelsea_Market', 
            'coordinates': [-74.00709440985004, 40.74297860932785],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Chelsea Market</strong>'
            },
        },
        {
            'name':'dumbo', 
            'coordinates': [-73.9895654438239, 40.70327270973695],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Dumbo</strong>'
            },
        },
        {
            'name':'brooklyn_bridge', 
            'coordinates': [-74.00413638187004, 40.71207823522519],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Brooklyn Bridge</strong>'
            },
        },
        {
            'name':'times_square', 
            'coordinates': [-73.98509174765091, 40.75887535728424],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Times Square</strong>'
            },
        },
        {
            'name':'library', 
            'coordinates': [-73.98179112809936, 40.75302159181419],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Public Library</strong>'
            },
        },
        {
            'name':'Rockefeller Center ', 
            'coordinates': [-73.97848978700577, 40.758676337214666],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Rockefeller Center</strong>'
            },
        },
        {
            'name':'St. Patrick Cathedral ', 
            'coordinates': [-73.97671991446636, 40.7587227423345],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>St. Patrick&apos;s Cathedral </strong>'
            },
        },
        {
            'name':'coney island', 
            'coordinates': [-73.9722983562747, 40.57399455756752],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Coney Island</strong>'
            },
        },
        {
            'name':'little italy', 
            'coordinates': [-73.99749707157666, 40.718917944464266],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>Little Italy</strong>'
            },
        },
        {
            'name':'5av', 
            'coordinates': [-73.97412042438978, 40.7627888518484],
            'color': '#007bff',
            'properties': {
            'description':
            '<strong>5av</strong>'
            },
        },
    ],
    // place to eat
    [
    {
            'name':'Borgo rosso di sera', 
            'coordinates': [16.07182033309263, 39.286312960759034],
            'color': '#28a745',
            'properties': {
            'description':
            '<strong>Borgo Rosso di Sera</strong><p>Great place to try typical products. <a href="http://www.borgorossodisera.com/" target="_blank" title="clicca qui" rel="nofollow"> website</a></p>'
            },
        },    
        {
            'name':'vecchio ulivo', 
            'coordinates': [16.263342, 39.263735],
            'color': '#28a745',
            'properties': {
            'description':
            '<strong>Al Vecchio Ulivo</strong><p>Great place to try typical products. <a href="https://www.facebook.com/people/Al-vecchio-ulivo/100054470499583/" target="_blank" title="clicca qui"> website</a></p>'
            },
        }
    ],
    //place to shot
    [
        {
            'name':'loc ', 
            'coordinates': [16.257499655780663,39.28692244554949],
            'color': '#dc3545',
            'properties': {
            'description':
            '<strong>Castello Svevo</strong><div style="text-align:center"><img width="'+img_w+'" height="'+img_h+'" src="images/cosenza/pic_cs_2.jpg"/></div><p>Come and discover this place <a href="http://www.castellocosenza.it/" target="_blank" title="scopri il castello" rel="nofollow">here</a>.</p>'
            },
        },
        {
            'name':'loc ', 
            'coordinates': [15.792102619838204,39.85488110500802],
            'color': '#dc3545',
            'properties': {
            'description':
            '<strong>Arco Magno</strong><div style="text-align:center"><img width="'+img_w+'" height="'+img_h+'" src="https://i.pinimg.com/736x/39/e5/b8/39e5b88c0ace231d77566ce1a32ce1bf.jpg"/></div><p>Come and discover this place <a href="https://iitalycalabria.com/cosenza-province/arco-magno-beach/" target="_blank" title="scopri il castello" rel="nofollow">here</a>.</p>'
            },
        }
    ],
    //place to go
    [
        {
            'name':'Camigliatello', 
            'coordinates': [16.44396137834741, 39.339140069521505],
            'color': '#FFA500',
            'properties': {
            'description':
            '<strong>Camigliatello Silano</strong><div style="text-align:center"></div><div><a id="try" style="cursor: pointer;"> Ride here </a></div>',
            
             },
        },
        {
            'name':'Amantea', 
            'coordinates': [16.07605117497829, 39.133969576929445],
            'color': '#FFA500',
            'properties': {
            'description':
            '<strong>Amantea</strong><div style="text-align:center"></div><p>Ride here.</p>'
            },
        }
    ]
];
   

let currentMarkers = [];

function clearMarkers() {
    // Trova tutti gli elementi dei marker con la classe mapboxgl-marker
    const markerElements = document.querySelectorAll('.mapboxgl-marker');

    // Itera attraverso gli elementi e rimuovili
    markerElements.forEach((markerElement) => {
        markerElement.remove();
    });

    if (map.getLayer('markers')) {
        map.removeLayer('markers');
    }
    if (map.getSource('markers')) {
        map.removeSource('markers');
    }

    map.on('load', () => {})
    currentMarkers = []; // Svuota l'array dei marker correnti
}

function addMarkersToSource(mpSet) {
    clearMarkers();
    
    const sourceId = 'markers';
    const features = mpSet.map((e) => {
        const name_marker=e.name;
       

        const coordinates = e.coordinates.slice();
        const description = e.properties.description;
        const color = e.color;

        const popup = new mapboxgl.Popup({ closeOnClick: true })
            .setHTML(description);

        const marker = new mapboxgl.Marker({
            color

        })
            .setLngLat(coordinates)
            .setPopup(popup)
            .addTo(map);

        marker.getElement().addEventListener('click', () => {
            console.log(name_marker);
            if (name_marker === "Amantea") {
                const page=document.querySelector('#c1');
                page.style.display = "block";
                 // Modifica il testo all'interno della sezione
                page.querySelector('.content-img').style.backgroundImage = 'url(images/cosenza/pic_cs_21.png)';
                page.querySelector('.content-title').textContent = 'Sea places';
                page.querySelector('.content-subtitle').textContent = 'Come here to discover these beautiful locations';
                page.querySelector('.content-paragraph').innerHTML = 'A beautiful sea view will fascinate you, come and discover these magical landscape! <br> Small villages close to the coast, perfect for a relaxing walk. Between medieval castles and beautiful beaches, enjoy the Tyrrhenian coast in all its beauty.';
                page.querySelector('.content-paragraph2').innerHTML = 'Come and have a swim in the beautiful beaches of Calabria, moving a little you will find different beaches and backdrops, choose your favorite. <br>The sunset awaits you to offer you a wonderful show of lights and colors. From "Arco Magno" to "Diamante", "Fuscaldo", "Paola" to "Amantea", it’s nice to drive overlooking the sea.';
            }
            else if (name_marker === "Camigliatello") {
                const page=document.querySelector('#c1');
                page.style.display = "block";
                 // Modifica il testo all'interno della sezione
                page.querySelector('.content-img').style.backgroundImage = 'url(images/cosenza/pic_cs_11.png)';
                page.querySelector('.content-title').textContent = 'Mountain places';
                page.querySelector('.content-subtitle').textContent = 'Come here to discover these beautiful locations';
                page.querySelector('.content-paragraph').innerHTML = 'The landscape of the mountains, always changing, follows the course of the seasons and goes from autumn yellow, to white in winter, up to a lush green in spring. <br>Everything follows the course of the seasons, the food you can find is always fresh and seasonal; the sports to practice follow the seasons, from skiing to nature excursions by bike or on foot.';
                page.querySelector('.content-paragraph2').textContent = 'Sila offers beautiful routes to do by motorbike or car. Spectacular landscapes for those who love nature photography. Picnic areas equipped for a day in company.';
            }
        });


        return {
            type: 'Feature',
            geometry: {
                type: 'Point',
                coordinates: coordinates
            },
            properties: {
                title: e.name,
                description: e.properties.description,
                color: e.color
            }
        };

        
    });

    map.addSource(sourceId, {
        type: 'geojson',
        data: {
            type: 'FeatureCollection',
            features: features
        }
    });

    map.addLayer({
        id: 'markers',
        type: 'symbol',
        source: sourceId,
        layout: {
            // Imposta il layout del tuo layer
        }
    });
    // map.on('click','markers', (e) => {
    //     console.log(e);
    // });

    map.setZoom(12);
    map.setCenter([-73.97866080866328, 40.763448563089725]);
    currentMarkers = mpSet;
    console.log(currentMarkers);
    
    map.on('load', () => {
        
    });

//     map.on('click', map.getLayer('markers'), function(e) {
//         console.log('ok2');
//     });

//     document.querySelectorAll('.mapboxgl-marker').forEach((markerElement) => {
//     markerElement.addEventListener('click', () => {
//         console.log(markerElement.getElement());
//     });
// })
}
    
// map.on('click', function (e) {
//     var features = map.queryRenderedFeatures(e.point, {
//         layers: ['markers'] // Specifica il nome del tuo layer
//     });

//     if (features.length > 0) {
//         var feature = features[0]; // Prendi la prima feature trovata
//         var markerId = feature.properties.id; // Sostituisci "id" con il nome della tua proprietà
//         alert('Hai cliccato sul marker con ID: ' + markerId);
//     } else {
//         // Il clic non è avvenuto su un marker
//         alert('Clic non su un marker.');
//     }
// });



document.getElementById('style1-button').addEventListener('click', () => {
    addMarkersToSource(mpSets[0]);
});

document.getElementById('style2-button').addEventListener('click', () => {
    addMarkersToSource(mpSets[1]);
});

document.getElementById('style3-button').addEventListener('click', () => {
    addMarkersToSource(mpSets[2]);
});

document.getElementById('style4-button').addEventListener('click', () => {
    addMarkersToSource(mpSets[3]);
});
    
addMarkersToSource(mpSets[0]) ;


</script>